---
import projects from '../../data/github-projects.json'
import { marked } from 'marked'

export async function getStaticPaths() {
  return projects.map(project => ({
    params: { slug: project.slug },
    props: project
  }))
}

const { title, repo } = Astro.props

const readmeUrl = `https://raw.githubusercontent.com/${repo}/main/README.md`
const readme = await fetch(readmeUrl).then(r => r.text())
const html = marked(readme)
---

<section class="mx-auto max-w-3xl px-6 py-12">
  <h1 class="mb-6 text-3xl font-bold">{title}</h1>

  <article class="prose prose-invert max-w-none">
    <div set:html={html} />
  </article>

  <a
    class="mt-10 inline-block text-sm opacity-70 hover:opacity-100"
    href={`https://github.com/${repo}`}
    target="_blank"
  >
    View on GitHub â†’
  </a>
</section>
